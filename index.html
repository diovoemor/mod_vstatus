<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <title>Mod_vstatus by romses</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Mod_vstatus</h1>
        <h2>Apache module for displaying HTTP error Codes for virtual hosts</h2>

        <section id="downloads">
          <a href="https://github.com/romses/mod_vstatus/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/romses/mod_vstatus/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/romses/mod_vstatus" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a name="mod_vstatus" class="anchor" href="#mod_vstatus"><span class="octicon octicon-link"></span></a>mod_vstatus</h1>

<h3>
<a name="statistic-tool-for-managing-vhosts-in-apache2" class="anchor" href="#statistic-tool-for-managing-vhosts-in-apache2"><span class="octicon octicon-link"></span></a>statistic tool for managing vhosts in apache2</h3>

<p>mod vstatus is a tool to collect apache requests summarized by vhost and status-code.</p>

<h2>
<a name="highlights" class="anchor" href="#highlights"><span class="octicon octicon-link"></span></a>Highlights</h2>

<ul>
<li>highly configurable</li>
<li>different output styles (csv,google charts, html)</li>
<li>filter by status code</li>
</ul><h2>
<a name="example-output" class="anchor" href="#example-output"><span class="octicon octicon-link"></span></a>example output</h2>

<h3>
<a name="csv" class="anchor" href="#csv"><span class="octicon octicon-link"></span></a>csv</h3>

<pre><code>Time,Host,Total,1xx,2xx,3xx,4xx,5xx,100,101,200,201,202,203,204,205,206,300,301,302,303,304,305,306,307,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,500,501,502,503,504,505
1394439580,Total,4497,0,3688,646,127,36,0,0,3182,0,0,0,0,0,506,0,531,3,2,110,0,0,0,1,97,0,0,10,0,0,0,19,0,0,0,0,0,0,0,0,0,36,0,0,0,0,0
1394439580,&lt;UNNAMED&gt;,122,0,103,0,19,0,0,0,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1394439580,&lt;VHOST1&gt;,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1394439580,&lt;VHOST2&gt;,347,0,343,4,0,0,0,0,343,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1394439580,&lt;VHOST3&gt;,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1394439565,Total,4497,0,3688,646,127,36,0,0,3182,0,0,0,0,0,506,0,531,3,2,110,0,0,0,1,97,0,0,10,0,0,0,19,0,0,0,0,0,0,0,0,0,36,0,0,0,0,0
1394439565,&lt;UNNAMED&gt;,122,0,103,0,19,0,0,0,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1394439565,&lt;VHOST1&gt;,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1394439565,&lt;VHOST2&gt;,347,0,343,4,0,0,0,0,343,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1394439565,&lt;VHOST3&gt;,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</code></pre>

<h2>
<a name="quick-start" class="anchor" href="#quick-start"><span class="octicon octicon-link"></span></a>Quick-start</h2>

<pre><code>checkout sourcecode
make
make install
</code></pre>

<p>add the following config directives to the apache config (e.g. /etc/apache2/http.conf)</p>

<pre><code>&lt;Location /vstatus&gt;
    SetHandler vstatus
    Order deny,allow
    Allow from 127.0.0.0/255.0.0.0
    Allow From 192.168.20.0/24
&lt;/Location&gt;

vstatusHistSize 120             #log 120 values per vhost
vstatusGranularity 1            # 1 second per log entry
# time monitored = vstatusGranularity*vstatusHistSize = 120 seconds

#vstatusFilter  &lt;NAME&gt; 0 1 2 3 4 5  # summarize error-codes (0 = all errors, 1 = 1xx ...)
#vstatusFormat  &lt;NAME&gt; &lt;format&gt;     # format=&lt;csv,json,google,htmldumpcsv,dump-json&gt;
#vstatusType    &lt;NAME&gt; abs          # &lt;abs|rel&gt; show absolute or relative values
#vstatusComment &lt;NAME&gt; Test         # comment

vstatusFilter  csv 0 1 2 3 4 404 5  # summarize error-codes (0 = all errors, 1 = 1xx ...)
vstatusFormat  csv csv
vstatusType    csv abs
vstatusComment csv Test

vstatusFilter  csv-rel 0 1 2 3 4 5
vstatusFormat  csv-rel csv
vstatusType    csv-rel rel
vstatusDelta   csv-rel 60
vstatusComment csv-rel "Shows all, 1xx,2xx,3xx,4xx,5xx codes based on the last 60 seconds"

vstatusFilter  google 0 1 2 3 4 5
vstatusFormat  google google
vstatusDelta   google 60
vstatusComment google "Data for google chart tools"
</code></pre>

<h3>
<a name="parameters" class="anchor" href="#parameters"><span class="octicon octicon-link"></span></a>Parameters</h3>

<p>First, there are two parameter, <strong>vstatusHistSize</strong> and <strong>vstatusGranularity</strong>. These parameters controlls, wow many data values are stored, and how often, they are renewed.</p>

<p><strong>vstatusHistSize</strong> controls, how many lines the data-table woll hold for each vhost.
e.g. <strong>vstatusHistSize</strong> 120 will hold 120 lines for each vhost.</p>

<p><strong>vstatusGranularity</strong> will control the amount of time in seconds, a line will be active.</p>

<p>e.g. <strong>vstatusGranularity</strong> 1 will create a new line every second.</p>

<p>Therefor, vstatusHistSize 120 and vstatusGranularity 1 will hold data for two minutes</p>

<h3>
<a name="filters" class="anchor" href="#filters"><span class="octicon octicon-link"></span></a>Filters</h3>

<p>For getting the data stored in the internal table, you will need a filter. Filters requires several parameters.</p>

<p>A Filter will be create on the fly, by naming it as the fist parameter i one of the following commands: <strong>vstatusFilter</strong>, <strong>vstatusFormat</strong>, <strong>vstatusType</strong>, <strong>vstatusDelta</strong>, <strong>vstatusDelta</strong></p>

<h4>
<a name="vstatusfilter" class="anchor" href="#vstatusfilter"><span class="octicon octicon-link"></span></a>vstatusFilter</h4>

<p><strong>vstatusFilter </strong> declares, which response-codes will be exported.
0 - summarize all status-codes (all hits)
1 - summarize all 1xx-codes
...
5 - summarize all 5xx-codes</p>

<p>100 - list all 100-codes
404 - list all "Page not found" codes</p>

<h4>
<a name="vstatusformat" class="anchor" href="#vstatusformat"><span class="octicon octicon-link"></span></a>vstatusFormat</h4>

<p><strong>vstatusFormat </strong> declares, how the data will be formatted
valid statements are:
    html      - creates human readable output
    csv       - creates csv-content ,,
    json      - creates a json-object containing the colelcted data.
    google    - creates a google-json for using in google chart-tools
    dump-json - dump the complete internal table as a json-object
    dump-csv  - dump the complete internal table using csv-output</p>

<h4>
<a name="vstatustype" class="anchor" href="#vstatustype"><span class="octicon octicon-link"></span></a>vstatusType</h4>

<p><strong>vstatusType </strong> declares, if the data will be delta or absolut values
 - raw hits will be displayed. this counter will be resettet, if apache is restarted
 - delta hits. val = val(newest non-active line) - val(newest non-active line - vstatusDelta)</p>

<h4>
<a name="vstatusdelta" class="anchor" href="#vstatusdelta"><span class="octicon octicon-link"></span></a>vstatusDelta</h4>

<p><strong>vstatusDelta </strong> controls the timeperiod used for . If missing, 1 will be set</p>

<h4>
<a name="vstatuscomment" class="anchor" href="#vstatuscomment"><span class="octicon octicon-link"></span></a>vstatusComment</h4>

<p><strong>vstatusComment </strong> just a comment for the Filter. Shown in the overview-page</p>

<h3>
<a name="accessing-the-data" class="anchor" href="#accessing-the-data"><span class="octicon octicon-link"></span></a>accessing the data</h3>

<p>All data can be accessed via get-requests. The example defines a Location called "vstatus".
getting http:///vstatus will show you a overview-page with several informations including a list of all defined filters.
Clicking a filter will show you the data, defined by the filter.</p>

<h3>
<a name="author---christopher-kreitz" class="anchor" href="#author---christopher-kreitz"><span class="octicon octicon-link"></span></a>Author - <a href="https://github.com/romses">Christopher Kreitz</a>
</h3>
      </section>
    </div>

    
  </body>
</html>